<html>  
 <head>  
   <title> Party Details</title>  
   <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.2.15/angular.min.js"></script>
       <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!-- styles -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script>
  <link href="css/styles.css" rel="stylesheet">  
<script type="text/javascript" src="js/01.js"></script>
<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
  
   <style>  
     .odd {  
       background-color: antiquewhite;  
       color: #008b8b;  
     }  
     td th {  
       height: 30px;  
       min-width: 100px;  
     }  
     thead {  
     
       color: white;  
       height: 30px;  
     }  
   </style>  
 </head>  
 <body ng-app="app" ng-controller="party">  
     <div ng-include="'menu.html'"></div>	
	<button class="btn btn-info" style="align:left" onclick="fnExcelReport()" class='gen_btn'>Export in Excel</button> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <input style="align:right" type="text" ng-model="search.$"  placeholder="Filter table :"/>
	
<div class="table-responsive">
     <table id="headerTable" class="table table-striped">  
       <thead>  
         <tr>  
         <th><input id="ckbCheckAll" type="checkbox" > </th>
           <th>index</th>  
           <th>  
             <a href="" ng-click="order('party.partyName')">Party Name</a>  
           </th>  
           <th><a href="" ng-click="order('party.mobileNo')"> Mobile Number</a> </th>  
           <th><a href="" ng-click="order('party.geoLocation')">Geo Location</a> </th>
           <th><a href="" ng-click="order('party.partyAddress1')">Address Line 1</a> </th>
           <th><a href="" ng-click="order('party.partyAddress2')">Address Line 2</a> </th>
           <th><a href="" ng-click="order('party.landmark')">Landmark</a> </th>
           <th><a href="" ng-click="order('party.village')">Village</a> </th>
           <th><a href="" ng-click="order('party.taluka')">Taluka</a> </th>
           <th><a href="" ng-click="order('party.district')">Distict</a> </th>
           <th><a href="" ng-click="order('party.state')">State</a> </th>
           <th><a href="" ng-click="order('party.postalCode')">Pincode</a> </th>
             
             <th><a href="" ng-click="order('party.postalCode')">Number of family members?</a> </th>
             <th><a href="" ng-click="order('party.postalCode')">Number of women?</a> </th>
             <th><a href="" ng-click="order('party.postalCode')">Number of men?</a> </th>
             <th><a href="" ng-click="order('party.postalCode')">Number of children?</a> </th>
             <th><a href="" ng-click="order('party.postalCode')">Is the house-hold using stove?</a> </th>
         </tr>  
       </thead>  
       <tbody>  
         <tr ng-repeat="party in parties | orderBy:predicate:reverse | filter:search" ng-class-odd="'odd'">
         <td><input class="checkBoxClass" type="checkbox" ></td>  
           <td>  
            
  {{$index+1}} 
               
           </td>  
             <td>{{party.party.partyName }}</td>
      <td> {{ party.party.mobileNo }}</td>
      <td> {{ party.party.geoLocation }}</td>
      <td> {{ party.party.partyAddress1 }}</td>
      <td> {{ party.party.partyAddress2 }}</td>
      <td>{{ party.party.landmark }}</td>
      <td>{{ party.party.village }}</td>
      <td>{{ party.party.taluka }}</td>
      <td>{{ party.party.district }}</td>
      <td>{{ party.party.state }}</td>
      <td>{{ party.party.postalCode }}</td>
      <!-- ng-repeat=" answers in party.answers" -->
      <td ng-if="party.answers[0].answer">
      {{ party.answers[0].answer }}</td>
       <!-- <td ng-else>
      {{ "NA" }}</td> -->
 <td ng-if="party.answers[1].answer">
      {{ party.answers[1].answer }}</td>
      <!-- <td ng-else>
      {{ "NA" }}</td> -->
      
 <td ng-if="party.answers[2].answer">
      {{ party.answers[2].answer }}</td>
    <!--   <td ng-else>
      {{ "NA" }}</td> -->
 <td ng-if="party.answers[3].answer">
      {{ party.answers[3].answer }}</td>
     <!--  <td ng-else>
      {{ "NA" }}</td> -->
 <td ng-if="party.answers[4].answer" >
      {{ party.answers[4].answer }}</td>
      <!-- <td ng-else>
      {{ "NA" }}</td> -->
         </tr> 
         <tr>  
           <td>Filter =>></td>  
           <td> <input type="text" ng-model="search.party.partyName" /></td>  
           <td> <input type="text" ng-model="search.party.mobileNo" /> </td>  
           <td><input type="text" ng-model="search.party.geoLocation" /> </td>
           <td><input type="text" ng-model="search.party.partyAddress1" /> </td>
           <td><input type="text" ng-model="search.party.partyAddress2" /> </td>
           <td><input type="text" ng-model="search.party.landmark" /> </td>
           <td><input type="text" ng-model="search.party.village" /> </td>
           <td><input type="text" ng-model="search.party.taluka" /> </td>
           <td><input type="text" ng-model="search.party.district" /> </td>
           <td><input type="text" ng-model="search.party.state" /> </td>
           <td><input type="text" ng-model="search.party.postalCode" /> </td>
           <td><input type="text" ng-model="search.party.postalCode" /> </td>
           <td><input type="text" ng-model="search.party.postalCode" /> </td>
           <td><input type="text" ng-model="search.party.postalCode" /> </td>
           <td><input type="text" ng-model="search.party.postalCode" /> </td>
           <td><input type="text" ng-model="search.party.postalCode" /> </td>
           
           
             
         </tr>  
          
       </tbody>  
     </table>

</div>  
 <script type="text/javascript">  
        $(document).ready(function () {  
            $('.dropdown-toggle').dropdown();  
        });  
   </script>
   
   <script type="text/javascript">
function fnExcelReport()
{
    var tab_text="<table border='2px'><tr bgcolor='#87AFC6'>";
    var textRange; var j=0;
    tab = document.getElementById('headerTable'); // id of table

    for(j = 0 ; j < tab.rows.length ; j++) 
    {     
        tab_text=tab_text+tab.rows[j].innerHTML+"</tr>";
        //tab_text=tab_text+"</tr>";
    }

    tab_text=tab_text+"</table>";
    tab_text= tab_text.replace(/<A[^>]*>|<\/A>/g, "");//remove if u want links in your table
    tab_text= tab_text.replace(/<img[^>]*>/gi,""); // remove if u want images in your table
    tab_text= tab_text.replace(/<input[^>]*>|<\/input>/gi, ""); // reomves input params

    var ua = window.navigator.userAgent;
    var msie = ua.indexOf("MSIE "); 

    if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./))      // If Internet Explorer
    {
        txtArea1.document.open("txt/html","replace");
        txtArea1.document.write(tab_text);
        txtArea1.document.close();
        txtArea1.focus(); 
        sa=txtArea1.document.execCommand("SaveAs",true,"Say Thanks to Sumit.xls");
    }  
    else                 //other browser not tested on IE 11
        sa = window.open('data:application/vnd.ms-excel,' + encodeURIComponent(tab_text));  

    return (sa);
}

$("#ckbCheckAll").click(function () {
    $(".checkBoxClass").prop('checked', $(this).prop('checked'));
});

</script> 

 </body>  
 </html>  