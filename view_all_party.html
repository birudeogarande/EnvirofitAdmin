<!DOCTYPE html>
<html ng-app="app">  
  <head>
  <style type="text/css">
   height: 100%;
   
   </style>
    <title>Organization Details</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap -->
    <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!-- styles -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script>

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/jquery-ui.min.js"></script>

<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.7/angular.min.js"></script>
<script type="text/javascript" src="js/01.js"></script>
    <link href="css/styles.css" rel="stylesheet">
  </head>
  <body>
  <div ng-include="'menu.html'"></div>
      <div class="page-content" >
  	  	<div ng-controller="party">
		  			
<button onclick="fnExcelReport()" class='gen_btn'>Export in Excel</button>
<table id="headerTable" class="table table-hover">
  <thead>
     <tr>
      <th>index</th>
      <th>Party Name</th>
      <th>Mobile Number</th>
      <th>Geo Location</th>
      <th>Address Line 1</th>
      <th>Address Line 2</th>
      <th>Landmark</th>
      <th>Village</th>
      <th>Taluka</th>
      <th>Distict</th>
      <th>State</th>
      <th>Pincode</th>
      <th>Question1 </th>
      <th>Question2</th>
      <th>Question3</th>
       <th>Question4</th>
       <th>Question5</th>
       <th>Question6</th>
      
     </tr>
  </thead> 
  <tbody>
    <tr ng-repeat="party in parties" >
       <td>{{$index+1}}</td>
      <td>{{party.party.partyName }}</td>
      <td> {{ party.party.mobileNo }}</td>
      <td> {{ party.party.geoLocation }}</td>
      <td> {{ party.party.partyAddress1 }}</td>
      <td> {{ party.party.partyAddress2 }}</td>
      <td>{{ party.party.landmark }}</td>
      <td>{{ party.party.village }}</td>
      <td>{{ party.party.taluka }}</td>
      <td>{{ party.party.district }}</td>
      <td>{{ party.party.state }}</td>
      <td>{{ party.party.postalCode }}</td>
      <td  ng-repeat="answer1 in party.answers">
      
	          {{answer1.question +"?"}}
	          
	                    	{{answer1.answer}}
	                    	
      
      </td>
      
    </tr>
  
  </tbody>
</table>
		  			
<!-- 		  				<div class="col-md-12" ng-repeat="party in parties">
							<div class="panel panel-info">
                         <div class="panel-heading">
                         <label style="color:green">{{ "Party Name: " + party.party.partyName }}</label>
                         </div>
      				<div class="panel-body">
      				
      				<div class="row">
	                    	<div class="col-md-3">
	                    	<label>Mobile Number:</label>
	                    	</div>
	                    	<div class="col-md-3">
	                    	 {{ party.party.mobileNo }}
	                    	</div>	
	                    	
	                    	<div class="col-md-3">
	                    	<label>Geo Location</label>
	                    	</div>
	                    	<div class="col-md-3">
	                    	 {{ party.party.geoLocation }}
	                    	</div>	
	                    	</div>
      				
      					  	<div class="row">
	                    	<div class="col-md-3">
	                    	<label>Address Line 1</label>
	                    	</div>
	                    	<div class="col-md-3">
	                    	 {{ party.party.partyAddress1 }}
	                    	</div>	
	                    	
	                    	<div class="col-md-3">
	                    	<label>Address Line 2</label>
	                    	</div>
	                    	<div class="col-md-3">
	                    	 {{ party.party.partyAddress2 }}
	                    	</div>	
	                    	</div>

								

						   <div class="row">
	                    	<div class="col-md-3">
	                    	<label>Landmark</label>
	                    	</div>
	                    	<div class="col-md-3">
	                    	{{ party.party.landmark }}
	                    	</div>	
	                    	
	                    	<div class="col-md-3">
	                    	<label>
	                    	Village</label>
	                    	</div>
	                    	<div class="col-md-3">
	                    	 {{ party.party.village }}
	                    	</div>	
	                    	</div>

							<div class="row">
	                    	<div class="col-md-3">
	                    	<label>Taluka</label>
	                    	</div>
	                    	<div class="col-md-3">
	                    	{{ party.party.taluka }}
	                    	</div>	
	                    	
	                    	<div class="col-md-3">
	                    	<label>Distict</label>
	                    	</div>
	                    	<div class="col-md-3">
	                    	{{ party.party.district }}
	                    	</div>	
	                    	</div>


							<div class="row">
	                    	<div class="col-md-3">
	                    	<label>State</label>
	                    	</div>
	                    	<div class="col-md-3">
	                    	{{ party.party.state }}
	                    	</div>	
	                    	
	                    	<div class="col-md-3">
	                    	<label>Pincode</label>
	                    	</div>
	                    	<div class="col-md-3">
	                    	 {{ party.party.taluka }}
	                    	</div>	
	                    	</div>
	                    	
	                    	<div class="row" >
	                    	<div class="col-md-6">
	                    	<label>Questions :</label>
	                    	</div>
	                    	<div class="col-md-6">
	                    	<label>Answers :</label>
	                    	</div>
	                    	</div>
	                    	<div class="row"  ng-repeat="answer1 in party.answers">
	                    	<div class="col-md-6" >
	                    	<label>{{answer1.question +"?"}}</label>
	                    	</div>
	                    	<div class="col-md-6">
	                    	{{answer1.answer}}
	                    	</div>	
	                    	
	                    	</div>
	                    
				      				
      				</div>
      				</div>
   					
   					
   					 </div> -->
					
		  	</div>

							
		  				</div>
		  			
	  
    
     

 <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://code.jquery.com/jquery.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script src="js/custom.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.15.0/jquery.validate.min.js"></script>
   				 <!-- <script src="http://code.jquery.com/jquery-1.9.1.js"></script> -->
    <script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>

<script type="text/javascript">
function fnExcelReport()
{
    var tab_text="<table border='2px'><tr bgcolor='#87AFC6'>";
    var textRange; var j=0;
    tab = document.getElementById('headerTable'); // id of table

    for(j = 0 ; j < tab.rows.length ; j++) 
    {     
        tab_text=tab_text+tab.rows[j].innerHTML+"</tr>";
        //tab_text=tab_text+"</tr>";
    }

    tab_text=tab_text+"</table>";
    tab_text= tab_text.replace(/<A[^>]*>|<\/A>/g, "");//remove if u want links in your table
    tab_text= tab_text.replace(/<img[^>]*>/gi,""); // remove if u want images in your table
    tab_text= tab_text.replace(/<input[^>]*>|<\/input>/gi, ""); // reomves input params

    var ua = window.navigator.userAgent;
    var msie = ua.indexOf("MSIE "); 

    if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./))      // If Internet Explorer
    {
        txtArea1.document.open("txt/html","replace");
        txtArea1.document.write(tab_text);
        txtArea1.document.close();
        txtArea1.focus(); 
        sa=txtArea1.document.execCommand("SaveAs",true,"Say Thanks to Sumit.xls");
    }  
    else                 //other browser not tested on IE 11
        sa = window.open('data:application/vnd.ms-excel,' + encodeURIComponent(tab_text));  

    return (sa);
}

</script>
  </body>
</html>